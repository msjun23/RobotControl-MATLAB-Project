function dydt = three_link(t, y)
%THREE_LINK
%    DYDT = THREE_LINK(IZ1,IZ2,IZ3,L1,L2,L3,DTH1,DTH2,DTH3,G,M1,M2,M3,R1,R2,R3,TAU1,TAU2,TAU3,TH1,TH2,TH3)

%    This function was generated by the Symbolic Math Toolbox version 8.7.
%    09-Dec-2021 21:51:48

global Iz1 Iz2 Iz3 L1 L2 L3 g m1 m2 m3 r1 r2 r3 tau1 tau2 tau3

th1 = y(1);
dth1 = y(2);
th2 = y(3);
dth2 = y(4);
th3 = y(5);
dth3 = y(6);

et1 = Iz1.*Iz2+Iz1.*Iz3-L1.^2.*L2.^2.*m2.^2+L1.^2.*L2.^2.*m3.^2-L1.^2.*L3.^2.*m3.^2-Iz2.*L1.^2.*m1-Iz1.*L2.^2.*m2+Iz2.*L1.^2.*m2-Iz3.*L1.^2.*m1+Iz1.*L2.^2.*m3+Iz2.*L1.^2.*m3+Iz3.*L1.^2.*m2-Iz1.*L3.^2.*m3+Iz3.*L1.^2.*m3+L1.^2.*L2.^2.*m1.*m2-L1.^2.*L2.^2.*m1.*m3+L1.^2.*L3.^2.*m1.*m3-L1.^2.*L3.^2.*m2.*m3+L1.^2.*L2.*m2.^2.*r2.*2.0+L1.^2.*L3.*m3.^2.*r3.*2.0-L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2-L1.^2.*L2.^2.*m3.^2.*cos(th2).^2;
et2 = Iz2.*L1.*m1.*r1.*2.0+Iz3.*L1.*m1.*r1.*2.0+Iz1.*L2.*m2.*r2.*2.0+Iz1.*L3.*m3.*r3.*2.0-L1.^2.*m2.^2.*r2.^2.*cos(th2).^2+L1.^2.*L2.*m3.^2.*r3.*cos(th3).*2.0-L1.*L2.^2.*m1.*m2.*r1.*2.0+L1.*L2.^2.*m1.*m3.*r1.*2.0-L1.^2.*L2.*m1.*m2.*r2.*2.0-L1.*L3.^2.*m1.*m3.*r1.*2.0+L1.^2.*L2.*m2.*m3.*r2.*2.0-L1.^2.*L3.*m1.*m3.*r3.*2.0+L1.^2.*L3.*m2.*m3.*r3.*2.0+Iz1.*L2.*m3.*r3.*cos(th3).*2.0-L1.^2.*L2.*m3.^2.*r3.*cos(th2+th3).*cos(th2).*2.0-L1.^2.*L2.*m1.*m3.*r3.*cos(th3).*2.0+L1.^2.*L2.*m2.*m3.*r3.*cos(th3).*2.0+L1.*L2.*m1.*m2.*r1.*r2.*4.0+L1.*L3.*m1.*m3.*r1.*r3.*4.0-L1.^2.*L2.*m2.*m3.*r2.*cos(th2).^2.*2.0;
et3 = L1.^2.*m2.*m3.*r2.*r3.*cos(th2+th3).*cos(th2).*-2.0+L1.*L2.*m1.*m3.*r1.*r3.*cos(th3).*4.0;
et4 = Iz1.*Iz2.*Iz3-Iz2.*Iz3.*L1.^2.*m1-Iz1.*Iz3.*L2.^2.*m2+Iz2.*Iz3.*L1.^2.*m2-Iz1.*Iz2.*L3.^2.*m3+Iz1.*Iz3.*L2.^2.*m3+Iz2.*Iz3.*L1.^2.*m3-L1.^2.*L2.^2.*L3.^2.*m3.^3-Iz3.*L1.^2.*L2.^2.*m2.^2-Iz1.*L2.^2.*L3.^2.*m3.^2-Iz2.*L1.^2.*L3.^2.*m3.^2+Iz3.*L1.^2.*L2.^2.*m3.^2-Iz3.*L1.^2.*L2.^2.*m3.^2.*cos(th2).^2+Iz2.*Iz3.*L1.*m1.*r1.*2.0+Iz1.*Iz3.*L2.*m2.*r2.*2.0+Iz1.*Iz2.*L3.*m3.*r3.*2.0-Iz3.*L1.^2.*m2.^2.*r2.^2.*cos(th2).^2-Iz1.*L2.^2.*m3.^2.*r3.^2.*cos(th3).^2;
et5 = L1.^2.*L2.^2.*L3.*m3.^3.*r3.*2.0-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).^2+L1.^2.*L2.^2.*L3.^2.*m3.^3.*cos(th2).^2-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th3).^2+L1.^2.*L2.^2.*L3.^2.*m1.*m3.^2+L1.^2.*L2.^2.*L3.^2.*m2.^2.*m3+Iz3.*L1.^2.*L2.^2.*m1.*m2+Iz2.*L1.^2.*L3.^2.*m1.*m3-Iz3.*L1.^2.*L2.^2.*m1.*m3+Iz1.*L2.^2.*L3.^2.*m2.*m3-Iz2.*L1.^2.*L3.^2.*m2.*m3+Iz3.*L1.^2.*L2.*m2.^2.*r2.*2.0+Iz1.*L2.^2.*L3.*m3.^2.*r3.*2.0+Iz2.*L1.^2.*L3.*m3.^2.*r3.*2.0;
et6 = -Iz2.*L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2-L1.^2.*L2.^2.*L3.*m3.^3.*r3.*cos(th2).^2.*2.0-L1.^2.*L2.^2.*L3.^2.*m1.*m2.*m3-L1.*L2.^2.*L3.^2.*m1.*m3.^2.*r1.*2.0-L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*2.0-L1.^2.*L2.*L3.^2.*m2.^2.*m3.*r2.*2.0-L1.^2.*L2.^2.*L3.*m1.*m3.^2.*r3.*2.0-L1.^2.*L2.^2.*L3.*m2.^2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th2+th3).^2-Iz3.*L1.*L2.^2.*m1.*m2.*r1.*2.0-Iz2.*L1.*L3.^2.*m1.*m3.*r1.*2.0+Iz3.*L1.*L2.^2.*m1.*m3.*r1.*2.0-Iz3.*L1.^2.*L2.*m1.*m2.*r2.*2.0;
et7 = Iz1.*L2.*L3.^2.*m2.*m3.*r2.*-2.0-Iz2.*L1.^2.*L3.*m1.*m3.*r3.*2.0+Iz3.*L1.^2.*L2.*m2.*m3.*r2.*2.0-Iz1.*L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz2.*L1.^2.*L3.*m2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m1.*m3.^2.*r3.^2.*cos(th3).^2+L1.^2.*L3.^2.*m2.^2.*m3.*r2.^2.*cos(th2).^2-L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.^2.*m1.*m3.^2.*r1.*r3.^2.*cos(th3).^2.*2.0-L1.^2.*L3.*m2.^2.*m3.*r2.^2.*r3.*cos(th2).^2.*2.0-Iz3.*L1.^2.*L2.*m2.*m3.*r2.*cos(th2).^2.*2.0+L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.^2.*L3.^2.*m1.*m2.*m3.*r1.*2.0;
et8 = L1.^2.*L2.*L3.^2.*m1.*m2.*m3.*r2.*2.0+L1.^2.*L2.^2.*L3.*m1.*m2.*m3.*r3.*2.0+L1.*L2.^2.*L3.*m1.*m3.^2.*r1.*r3.*4.0+L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*4.0+L1.^2.*L2.*L3.*m2.^2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).^2.*2.0+L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*cos(th2).^2.*2.0+Iz3.*L1.*L2.*m1.*m2.*r1.*r2.*4.0+Iz2.*L1.*L3.*m1.*m3.*r1.*r3.*4.0+Iz1.*L2.*L3.*m2.*m3.*r2.*r3.*4.0-L1.*L2.*L3.^2.*m1.*m2.*m3.*r1.*r2.*4.0-L1.*L2.^2.*L3.*m1.*m2.*m3.*r1.*r3.*4.0-L1.^2.*L2.*L3.*m1.*m2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*cos(th2).^2.*4.0;
et9 = L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.*L3.*m1.*m2.*m3.*r1.*r2.*r3.*8.0;
et10 = Iz1.*Iz3-L1.^2.*L3.^2.*m3.^2-Iz3.*L1.^2.*m1+Iz3.*L1.^2.*m2-Iz1.*L3.^2.*m3+Iz3.*L1.^2.*m3+L1.^2.*L3.^2.*m1.*m3-L1.^2.*L3.^2.*m2.*m3+L1.^2.*L3.*m3.^2.*r3.*2.0-L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2+Iz3.*L1.*m1.*r1.*2.0+Iz1.*L3.*m3.*r3.*2.0-L1.*L2.^2.*m3.^2.*r3.*cos(th2+th3)-L1.*L2.*L3.^2.*m3.^2.*cos(th2)+L1.^2.*L2.*m3.^2.*r3.*cos(th3)-Iz2.*L1.*m3.*r3.*cos(th2+th3)+Iz3.*L1.*L2.*m3.*cos(th2)-L1.*L3.^2.*m1.*m3.*r1.*2.0-L1.^2.*L3.*m1.*m3.*r3.*2.0+L1.^2.*L3.*m2.*m3.*r3.*2.0+Iz3.*L1.*m2.*r2.*cos(th2);
et11 = Iz1.*L2.*m3.*r3.*cos(th3)-L1.^2.*L2.*m3.^2.*r3.*cos(th2+th3).*cos(th2)-L1.*L2.*m3.^2.*r3.^2.*cos(th2+th3).*cos(th3)+L1.*L2.^2.*m3.^2.*r3.*cos(th2).*cos(th3)+L1.*L2.^2.*m2.*m3.*r3.*cos(th2+th3)+L1.*L2.*L3.*m3.^2.*r3.*cos(th2).*2.0-L1.*L3.^2.*m2.*m3.*r2.*cos(th2)-L1.^2.*L2.*m1.*m3.*r3.*cos(th3)+L1.^2.*L2.*m2.*m3.*r3.*cos(th3)+L1.*L3.*m1.*m3.*r1.*r3.*4.0-L1.^2.*m2.*m3.*r2.*r3.*cos(th2+th3).*cos(th2)-L1.*L2.*m2.*m3.*r2.*r3.*cos(th2+th3).*2.0+L1.*L2.*m1.*m3.*r1.*r3.*cos(th3).*2.0+L1.*L3.*m2.*m3.*r2.*r3.*cos(th2).*2.0+L1.*L2.*m2.*m3.*r2.*r3.*cos(th2).*cos(th3);
et12 = Iz1.*Iz2.*Iz3-Iz2.*Iz3.*L1.^2.*m1-Iz1.*Iz3.*L2.^2.*m2+Iz2.*Iz3.*L1.^2.*m2-Iz1.*Iz2.*L3.^2.*m3+Iz1.*Iz3.*L2.^2.*m3+Iz2.*Iz3.*L1.^2.*m3-L1.^2.*L2.^2.*L3.^2.*m3.^3-Iz3.*L1.^2.*L2.^2.*m2.^2-Iz1.*L2.^2.*L3.^2.*m3.^2-Iz2.*L1.^2.*L3.^2.*m3.^2+Iz3.*L1.^2.*L2.^2.*m3.^2-Iz3.*L1.^2.*L2.^2.*m3.^2.*cos(th2).^2+Iz2.*Iz3.*L1.*m1.*r1.*2.0+Iz1.*Iz3.*L2.*m2.*r2.*2.0+Iz1.*Iz2.*L3.*m3.*r3.*2.0-Iz3.*L1.^2.*m2.^2.*r2.^2.*cos(th2).^2-Iz1.*L2.^2.*m3.^2.*r3.^2.*cos(th3).^2;
et13 = L1.^2.*L2.^2.*L3.*m3.^3.*r3.*2.0-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).^2+L1.^2.*L2.^2.*L3.^2.*m3.^3.*cos(th2).^2-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th3).^2+L1.^2.*L2.^2.*L3.^2.*m1.*m3.^2+L1.^2.*L2.^2.*L3.^2.*m2.^2.*m3+Iz3.*L1.^2.*L2.^2.*m1.*m2+Iz2.*L1.^2.*L3.^2.*m1.*m3-Iz3.*L1.^2.*L2.^2.*m1.*m3+Iz1.*L2.^2.*L3.^2.*m2.*m3-Iz2.*L1.^2.*L3.^2.*m2.*m3+Iz3.*L1.^2.*L2.*m2.^2.*r2.*2.0+Iz1.*L2.^2.*L3.*m3.^2.*r3.*2.0+Iz2.*L1.^2.*L3.*m3.^2.*r3.*2.0;
et14 = -Iz2.*L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2-L1.^2.*L2.^2.*L3.*m3.^3.*r3.*cos(th2).^2.*2.0-L1.^2.*L2.^2.*L3.^2.*m1.*m2.*m3-L1.*L2.^2.*L3.^2.*m1.*m3.^2.*r1.*2.0-L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*2.0-L1.^2.*L2.*L3.^2.*m2.^2.*m3.*r2.*2.0-L1.^2.*L2.^2.*L3.*m1.*m3.^2.*r3.*2.0-L1.^2.*L2.^2.*L3.*m2.^2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th2+th3).^2-Iz3.*L1.*L2.^2.*m1.*m2.*r1.*2.0-Iz2.*L1.*L3.^2.*m1.*m3.*r1.*2.0+Iz3.*L1.*L2.^2.*m1.*m3.*r1.*2.0-Iz3.*L1.^2.*L2.*m1.*m2.*r2.*2.0;
et15 = Iz1.*L2.*L3.^2.*m2.*m3.*r2.*-2.0-Iz2.*L1.^2.*L3.*m1.*m3.*r3.*2.0+Iz3.*L1.^2.*L2.*m2.*m3.*r2.*2.0-Iz1.*L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz2.*L1.^2.*L3.*m2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m1.*m3.^2.*r3.^2.*cos(th3).^2+L1.^2.*L3.^2.*m2.^2.*m3.*r2.^2.*cos(th2).^2-L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.^2.*m1.*m3.^2.*r1.*r3.^2.*cos(th3).^2.*2.0-L1.^2.*L3.*m2.^2.*m3.*r2.^2.*r3.*cos(th2).^2.*2.0-Iz3.*L1.^2.*L2.*m2.*m3.*r2.*cos(th2).^2.*2.0+L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.^2.*L3.^2.*m1.*m2.*m3.*r1.*2.0;
et16 = L1.^2.*L2.*L3.^2.*m1.*m2.*m3.*r2.*2.0+L1.^2.*L2.^2.*L3.*m1.*m2.*m3.*r3.*2.0+L1.*L2.^2.*L3.*m1.*m3.^2.*r1.*r3.*4.0+L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*4.0+L1.^2.*L2.*L3.*m2.^2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).^2.*2.0+L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*cos(th2).^2.*2.0+Iz3.*L1.*L2.*m1.*m2.*r1.*r2.*4.0+Iz2.*L1.*L3.*m1.*m3.*r1.*r3.*4.0+Iz1.*L2.*L3.*m2.*m3.*r2.*r3.*4.0-L1.*L2.*L3.^2.*m1.*m2.*m3.*r1.*r2.*4.0-L1.*L2.^2.*L3.*m1.*m2.*m3.*r1.*r3.*4.0-L1.^2.*L2.*L3.*m1.*m2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*cos(th2).^2.*4.0;
et17 = L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.*L3.*m1.*m2.*m3.*r1.*r2.*r3.*8.0;
et18 = Iz1.*Iz2.*Iz3-Iz2.*Iz3.*L1.^2.*m1-Iz1.*Iz3.*L2.^2.*m2+Iz2.*Iz3.*L1.^2.*m2-Iz1.*Iz2.*L3.^2.*m3+Iz1.*Iz3.*L2.^2.*m3+Iz2.*Iz3.*L1.^2.*m3-L1.^2.*L2.^2.*L3.^2.*m3.^3-Iz3.*L1.^2.*L2.^2.*m2.^2-Iz1.*L2.^2.*L3.^2.*m3.^2-Iz2.*L1.^2.*L3.^2.*m3.^2+Iz3.*L1.^2.*L2.^2.*m3.^2-Iz3.*L1.^2.*L2.^2.*m3.^2.*cos(th2).^2+Iz2.*Iz3.*L1.*m1.*r1.*2.0+Iz1.*Iz3.*L2.*m2.*r2.*2.0+Iz1.*Iz2.*L3.*m3.*r3.*2.0-Iz3.*L1.^2.*m2.^2.*r2.^2.*cos(th2).^2-Iz1.*L2.^2.*m3.^2.*r3.^2.*cos(th3).^2;
et19 = L1.^2.*L2.^2.*L3.*m3.^3.*r3.*2.0-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).^2+L1.^2.*L2.^2.*L3.^2.*m3.^3.*cos(th2).^2-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th3).^2+L1.^2.*L2.^2.*L3.^2.*m1.*m3.^2+L1.^2.*L2.^2.*L3.^2.*m2.^2.*m3+Iz3.*L1.^2.*L2.^2.*m1.*m2+Iz2.*L1.^2.*L3.^2.*m1.*m3-Iz3.*L1.^2.*L2.^2.*m1.*m3+Iz1.*L2.^2.*L3.^2.*m2.*m3-Iz2.*L1.^2.*L3.^2.*m2.*m3+Iz3.*L1.^2.*L2.*m2.^2.*r2.*2.0+Iz1.*L2.^2.*L3.*m3.^2.*r3.*2.0+Iz2.*L1.^2.*L3.*m3.^2.*r3.*2.0;
et20 = -Iz2.*L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2-L1.^2.*L2.^2.*L3.*m3.^3.*r3.*cos(th2).^2.*2.0-L1.^2.*L2.^2.*L3.^2.*m1.*m2.*m3-L1.*L2.^2.*L3.^2.*m1.*m3.^2.*r1.*2.0-L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*2.0-L1.^2.*L2.*L3.^2.*m2.^2.*m3.*r2.*2.0-L1.^2.*L2.^2.*L3.*m1.*m3.^2.*r3.*2.0-L1.^2.*L2.^2.*L3.*m2.^2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th2+th3).^2-Iz3.*L1.*L2.^2.*m1.*m2.*r1.*2.0-Iz2.*L1.*L3.^2.*m1.*m3.*r1.*2.0+Iz3.*L1.*L2.^2.*m1.*m3.*r1.*2.0-Iz3.*L1.^2.*L2.*m1.*m2.*r2.*2.0;
et21 = Iz1.*L2.*L3.^2.*m2.*m3.*r2.*-2.0-Iz2.*L1.^2.*L3.*m1.*m3.*r3.*2.0+Iz3.*L1.^2.*L2.*m2.*m3.*r2.*2.0-Iz1.*L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz2.*L1.^2.*L3.*m2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m1.*m3.^2.*r3.^2.*cos(th3).^2+L1.^2.*L3.^2.*m2.^2.*m3.*r2.^2.*cos(th2).^2-L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.^2.*m1.*m3.^2.*r1.*r3.^2.*cos(th3).^2.*2.0-L1.^2.*L3.*m2.^2.*m3.*r2.^2.*r3.*cos(th2).^2.*2.0-Iz3.*L1.^2.*L2.*m2.*m3.*r2.*cos(th2).^2.*2.0+L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.^2.*L3.^2.*m1.*m2.*m3.*r1.*2.0;
et22 = L1.^2.*L2.*L3.^2.*m1.*m2.*m3.*r2.*2.0+L1.^2.*L2.^2.*L3.*m1.*m2.*m3.*r3.*2.0+L1.*L2.^2.*L3.*m1.*m3.^2.*r1.*r3.*4.0+L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*4.0+L1.^2.*L2.*L3.*m2.^2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).^2.*2.0+L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*cos(th2).^2.*2.0+Iz3.*L1.*L2.*m1.*m2.*r1.*r2.*4.0+Iz2.*L1.*L3.*m1.*m3.*r1.*r3.*4.0+Iz1.*L2.*L3.*m2.*m3.*r2.*r3.*4.0-L1.*L2.*L3.^2.*m1.*m2.*m3.*r1.*r2.*4.0-L1.*L2.^2.*L3.*m1.*m2.*m3.*r1.*r3.*4.0-L1.^2.*L2.*L3.*m1.*m2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*cos(th2).^2.*4.0;
et23 = L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.*L3.*m1.*m2.*m3.*r1.*r2.*r3.*8.0;
et24 = L1.*(-Iz2.*m3.*r3.*cos(th2+th3)+Iz3.*L2.*m3.*cos(th2)+Iz3.*m2.*r2.*cos(th2)-L2.^2.*m3.^2.*r3.*cos(th2+th3)-L2.*L3.^2.*m3.^2.*cos(th2)+L2.^2.*m2.*m3.*r3.*cos(th2+th3)+L2.*L3.*m3.^2.*r3.*cos(th2).*2.0-L3.^2.*m2.*m3.*r2.*cos(th2)-L2.*m3.^2.*r3.^2.*cos(th2+th3).*cos(th3)+L2.^2.*m3.^2.*r3.*cos(th2).*cos(th3)-L2.*m2.*m3.*r2.*r3.*cos(th2+th3).*2.0+L3.*m2.*m3.*r2.*r3.*cos(th2).*2.0+L2.*m2.*m3.*r2.*r3.*cos(th2).*cos(th3));
et25 = (tau1-L2.*g.*m3.*cos(th1+th2)-g.*m2.*r2.*cos(th1+th2)-L1.*g.*m2.*cos(th1)-L1.*g.*m3.*cos(th1)-g.*m1.*r1.*cos(th1)-g.*m3.*r3.*cos(th1+th2+th3)+L1.*dth2.^2.*m3.*r3.*sin(th2+th3)+L1.*dth3.^2.*m3.*r3.*sin(th2+th3)+L1.*L2.*dth2.^2.*m3.*sin(th2)+L1.*dth2.^2.*m2.*r2.*sin(th2)+L2.*dth3.^2.*m3.*r3.*sin(th3)+L1.*dth1.*dth2.*m3.*r3.*sin(th2+th3).*2.0+L1.*dth1.*dth3.*m3.*r3.*sin(th2+th3).*2.0+L1.*dth2.*dth3.*m3.*r3.*sin(th2+th3).*2.0+L1.*L2.*dth1.*dth2.*m3.*sin(th2).*2.0+L1.*dth1.*dth2.*m2.*r2.*sin(th2).*2.0+L2.*dth1.*dth3.*m3.*r3.*sin(th3).*2.0+L2.*dth2.*dth3.*m3.*r3.*sin(th3).*2.0)./(et18+et19+et20+et21+et22+et23);
et26 = -((et1+et2+et3).*(-tau3-L2.^2.*dth2.^2.*m2.*sin(th3)+g.*m3.*r3.*cos(th1+th2+th3)+L1.*dth1.^2.*m3.*r3.*sin(th2+th3)+L2.*L3.*dth2.^2.*m2.*sin(th3)-L2.^2.*dth1.*dth2.*m2.*sin(th3)+L2.*dth2.^2.*m2.*r2.*sin(th3)+L2.*dth1.^2.*m3.*r3.*sin(th3)+L2.*L3.*dth1.*dth2.*m2.*sin(th3)+L2.*dth1.*dth2.*m2.*r2.*sin(th3)+L2.*dth1.*dth2.*m3.*r3.*sin(th3)))./(et4+et5+et6+et7+et8+et9);
et27 = ((-tau2+L2.*g.*m3.*cos(th1+th2)+g.*m2.*r2.*cos(th1+th2)+g.*m3.*r3.*cos(th1+th2+th3)+L1.*dth1.^2.*m3.*r3.*sin(th2+th3)+L1.*L2.*dth1.^2.*m3.*sin(th2)+L1.*dth1.^2.*m2.*r2.*sin(th2)-L2.*dth3.^2.*m3.*r3.*sin(th3)-L2.*dth1.*dth3.*m3.*r3.*sin(th3).*2.0-L2.*dth2.*dth3.*m3.*r3.*sin(th3).*2.0).*(et10+et11))./(et12+et13+et14+et15+et16+et17)+et24.*et25;
et28 = Iz1.*Iz3-L1.^2.*L3.^2.*m3.^2-Iz3.*L1.^2.*m1+Iz3.*L1.^2.*m2-Iz1.*L3.^2.*m3+Iz3.*L1.^2.*m3+L1.^2.*L3.^2.*m1.*m3-L1.^2.*L3.^2.*m2.*m3+L1.^2.*L3.*m3.^2.*r3.*2.0-L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2+Iz3.*L1.*m1.*r1.*2.0+Iz1.*L3.*m3.*r3.*2.0-L1.*L2.^2.*m3.^2.*r3.*cos(th2+th3)-L1.*L2.*L3.^2.*m3.^2.*cos(th2)+L1.^2.*L2.*m3.^2.*r3.*cos(th3)-Iz2.*L1.*m3.*r3.*cos(th2+th3)+Iz3.*L1.*L2.*m3.*cos(th2)-L1.*L3.^2.*m1.*m3.*r1.*2.0-L1.^2.*L3.*m1.*m3.*r3.*2.0+L1.^2.*L3.*m2.*m3.*r3.*2.0+Iz3.*L1.*m2.*r2.*cos(th2);
et29 = Iz1.*L2.*m3.*r3.*cos(th3)-L1.^2.*L2.*m3.^2.*r3.*cos(th2+th3).*cos(th2)-L1.*L2.*m3.^2.*r3.^2.*cos(th2+th3).*cos(th3)+L1.*L2.^2.*m3.^2.*r3.*cos(th2).*cos(th3)+L1.*L2.^2.*m2.*m3.*r3.*cos(th2+th3)+L1.*L2.*L3.*m3.^2.*r3.*cos(th2).*2.0-L1.*L3.^2.*m2.*m3.*r2.*cos(th2)-L1.^2.*L2.*m1.*m3.*r3.*cos(th3)+L1.^2.*L2.*m2.*m3.*r3.*cos(th3)+L1.*L3.*m1.*m3.*r1.*r3.*4.0-L1.^2.*m2.*m3.*r2.*r3.*cos(th2+th3).*cos(th2)-L1.*L2.*m2.*m3.*r2.*r3.*cos(th2+th3).*2.0+L1.*L2.*m1.*m3.*r1.*r3.*cos(th3).*2.0+L1.*L3.*m2.*m3.*r2.*r3.*cos(th2).*2.0+L1.*L2.*m2.*m3.*r2.*r3.*cos(th2).*cos(th3);
et30 = Iz1.*Iz2.*Iz3-Iz2.*Iz3.*L1.^2.*m1-Iz1.*Iz3.*L2.^2.*m2+Iz2.*Iz3.*L1.^2.*m2-Iz1.*Iz2.*L3.^2.*m3+Iz1.*Iz3.*L2.^2.*m3+Iz2.*Iz3.*L1.^2.*m3-L1.^2.*L2.^2.*L3.^2.*m3.^3-Iz3.*L1.^2.*L2.^2.*m2.^2-Iz1.*L2.^2.*L3.^2.*m3.^2-Iz2.*L1.^2.*L3.^2.*m3.^2+Iz3.*L1.^2.*L2.^2.*m3.^2-Iz3.*L1.^2.*L2.^2.*m3.^2.*cos(th2).^2+Iz2.*Iz3.*L1.*m1.*r1.*2.0+Iz1.*Iz3.*L2.*m2.*r2.*2.0+Iz1.*Iz2.*L3.*m3.*r3.*2.0-Iz3.*L1.^2.*m2.^2.*r2.^2.*cos(th2).^2-Iz1.*L2.^2.*m3.^2.*r3.^2.*cos(th3).^2;
et31 = L1.^2.*L2.^2.*L3.*m3.^3.*r3.*2.0-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).^2+L1.^2.*L2.^2.*L3.^2.*m3.^3.*cos(th2).^2-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th3).^2+L1.^2.*L2.^2.*L3.^2.*m1.*m3.^2+L1.^2.*L2.^2.*L3.^2.*m2.^2.*m3+Iz3.*L1.^2.*L2.^2.*m1.*m2+Iz2.*L1.^2.*L3.^2.*m1.*m3-Iz3.*L1.^2.*L2.^2.*m1.*m3+Iz1.*L2.^2.*L3.^2.*m2.*m3-Iz2.*L1.^2.*L3.^2.*m2.*m3+Iz3.*L1.^2.*L2.*m2.^2.*r2.*2.0+Iz1.*L2.^2.*L3.*m3.^2.*r3.*2.0+Iz2.*L1.^2.*L3.*m3.^2.*r3.*2.0;
et32 = -Iz2.*L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2-L1.^2.*L2.^2.*L3.*m3.^3.*r3.*cos(th2).^2.*2.0-L1.^2.*L2.^2.*L3.^2.*m1.*m2.*m3-L1.*L2.^2.*L3.^2.*m1.*m3.^2.*r1.*2.0-L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*2.0-L1.^2.*L2.*L3.^2.*m2.^2.*m3.*r2.*2.0-L1.^2.*L2.^2.*L3.*m1.*m3.^2.*r3.*2.0-L1.^2.*L2.^2.*L3.*m2.^2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th2+th3).^2-Iz3.*L1.*L2.^2.*m1.*m2.*r1.*2.0-Iz2.*L1.*L3.^2.*m1.*m3.*r1.*2.0+Iz3.*L1.*L2.^2.*m1.*m3.*r1.*2.0-Iz3.*L1.^2.*L2.*m1.*m2.*r2.*2.0;
et33 = Iz1.*L2.*L3.^2.*m2.*m3.*r2.*-2.0-Iz2.*L1.^2.*L3.*m1.*m3.*r3.*2.0+Iz3.*L1.^2.*L2.*m2.*m3.*r2.*2.0-Iz1.*L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz2.*L1.^2.*L3.*m2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m1.*m3.^2.*r3.^2.*cos(th3).^2+L1.^2.*L3.^2.*m2.^2.*m3.*r2.^2.*cos(th2).^2-L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.^2.*m1.*m3.^2.*r1.*r3.^2.*cos(th3).^2.*2.0-L1.^2.*L3.*m2.^2.*m3.*r2.^2.*r3.*cos(th2).^2.*2.0-Iz3.*L1.^2.*L2.*m2.*m3.*r2.*cos(th2).^2.*2.0+L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.^2.*L3.^2.*m1.*m2.*m3.*r1.*2.0;
et34 = L1.^2.*L2.*L3.^2.*m1.*m2.*m3.*r2.*2.0+L1.^2.*L2.^2.*L3.*m1.*m2.*m3.*r3.*2.0+L1.*L2.^2.*L3.*m1.*m3.^2.*r1.*r3.*4.0+L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*4.0+L1.^2.*L2.*L3.*m2.^2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).^2.*2.0+L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*cos(th2).^2.*2.0+Iz3.*L1.*L2.*m1.*m2.*r1.*r2.*4.0+Iz2.*L1.*L3.*m1.*m3.*r1.*r3.*4.0+Iz1.*L2.*L3.*m2.*m3.*r2.*r3.*4.0-L1.*L2.*L3.^2.*m1.*m2.*m3.*r1.*r2.*4.0-L1.*L2.^2.*L3.*m1.*m2.*m3.*r1.*r3.*4.0-L1.^2.*L2.*L3.*m1.*m2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*cos(th2).^2.*4.0;
et35 = L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.*L3.*m1.*m2.*m3.*r1.*r2.*r3.*8.0;
et36 = Iz1.*Iz3+Iz2.*Iz3-L1.^2.*L3.^2.*m3.^2-L2.^2.*L3.^2.*m3.^2-Iz3.*L1.^2.*m1+Iz3.*L1.^2.*m2-Iz1.*L3.^2.*m3+Iz3.*L1.^2.*m3-Iz3.*L2.^2.*m2-Iz2.*L3.^2.*m3+Iz3.*L2.^2.*m3+L1.^2.*L3.^2.*m1.*m3-L1.^2.*L3.^2.*m2.*m3+L2.^2.*L3.^2.*m2.*m3+L1.^2.*L3.*m3.^2.*r3.*2.0+L2.^2.*L3.*m3.^2.*r3.*2.0-L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2+Iz3.*L1.*m1.*r1.*2.0+Iz3.*L2.*m2.*r2.*2.0+Iz1.*L3.*m3.*r3.*2.0+Iz2.*L3.*m3.*r3.*2.0-L2.^2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.*L3.^2.*m3.^2.*cos(th2).*2.0;
et37 = Iz3.*L1.*L2.*m3.*cos(th2).*2.0-L1.*L3.^2.*m1.*m3.*r1.*2.0-L1.^2.*L3.*m1.*m3.*r3.*2.0-L2.*L3.^2.*m2.*m3.*r2.*2.0+L1.^2.*L3.*m2.*m3.*r3.*2.0-L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz3.*L1.*m2.*r2.*cos(th2).*2.0-L1.*L2.*m3.^2.*r3.^2.*cos(th2+th3).*cos(th3).*2.0+L1.*L2.*L3.*m3.^2.*r3.*cos(th2).*4.0-L1.*L3.^2.*m2.*m3.*r2.*cos(th2).*2.0+L1.*L3.*m1.*m3.*r1.*r3.*4.0+L2.*L3.*m2.*m3.*r2.*r3.*4.0+L1.*L3.*m2.*m3.*r2.*r3.*cos(th2).*4.0;
et38 = Iz1.*Iz2.*Iz3-Iz2.*Iz3.*L1.^2.*m1-Iz1.*Iz3.*L2.^2.*m2+Iz2.*Iz3.*L1.^2.*m2-Iz1.*Iz2.*L3.^2.*m3+Iz1.*Iz3.*L2.^2.*m3+Iz2.*Iz3.*L1.^2.*m3-L1.^2.*L2.^2.*L3.^2.*m3.^3-Iz3.*L1.^2.*L2.^2.*m2.^2-Iz1.*L2.^2.*L3.^2.*m3.^2-Iz2.*L1.^2.*L3.^2.*m3.^2+Iz3.*L1.^2.*L2.^2.*m3.^2-Iz3.*L1.^2.*L2.^2.*m3.^2.*cos(th2).^2+Iz2.*Iz3.*L1.*m1.*r1.*2.0+Iz1.*Iz3.*L2.*m2.*r2.*2.0+Iz1.*Iz2.*L3.*m3.*r3.*2.0-Iz3.*L1.^2.*m2.^2.*r2.^2.*cos(th2).^2-Iz1.*L2.^2.*m3.^2.*r3.^2.*cos(th3).^2;
et39 = L1.^2.*L2.^2.*L3.*m3.^3.*r3.*2.0-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).^2+L1.^2.*L2.^2.*L3.^2.*m3.^3.*cos(th2).^2-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th3).^2+L1.^2.*L2.^2.*L3.^2.*m1.*m3.^2+L1.^2.*L2.^2.*L3.^2.*m2.^2.*m3+Iz3.*L1.^2.*L2.^2.*m1.*m2+Iz2.*L1.^2.*L3.^2.*m1.*m3-Iz3.*L1.^2.*L2.^2.*m1.*m3+Iz1.*L2.^2.*L3.^2.*m2.*m3-Iz2.*L1.^2.*L3.^2.*m2.*m3+Iz3.*L1.^2.*L2.*m2.^2.*r2.*2.0+Iz1.*L2.^2.*L3.*m3.^2.*r3.*2.0+Iz2.*L1.^2.*L3.*m3.^2.*r3.*2.0;
et40 = -Iz2.*L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2-L1.^2.*L2.^2.*L3.*m3.^3.*r3.*cos(th2).^2.*2.0-L1.^2.*L2.^2.*L3.^2.*m1.*m2.*m3-L1.*L2.^2.*L3.^2.*m1.*m3.^2.*r1.*2.0-L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*2.0-L1.^2.*L2.*L3.^2.*m2.^2.*m3.*r2.*2.0-L1.^2.*L2.^2.*L3.*m1.*m3.^2.*r3.*2.0-L1.^2.*L2.^2.*L3.*m2.^2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th2+th3).^2-Iz3.*L1.*L2.^2.*m1.*m2.*r1.*2.0-Iz2.*L1.*L3.^2.*m1.*m3.*r1.*2.0+Iz3.*L1.*L2.^2.*m1.*m3.*r1.*2.0-Iz3.*L1.^2.*L2.*m1.*m2.*r2.*2.0;
et41 = Iz1.*L2.*L3.^2.*m2.*m3.*r2.*-2.0-Iz2.*L1.^2.*L3.*m1.*m3.*r3.*2.0+Iz3.*L1.^2.*L2.*m2.*m3.*r2.*2.0-Iz1.*L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz2.*L1.^2.*L3.*m2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m1.*m3.^2.*r3.^2.*cos(th3).^2+L1.^2.*L3.^2.*m2.^2.*m3.*r2.^2.*cos(th2).^2-L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.^2.*m1.*m3.^2.*r1.*r3.^2.*cos(th3).^2.*2.0-L1.^2.*L3.*m2.^2.*m3.*r2.^2.*r3.*cos(th2).^2.*2.0-Iz3.*L1.^2.*L2.*m2.*m3.*r2.*cos(th2).^2.*2.0+L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.^2.*L3.^2.*m1.*m2.*m3.*r1.*2.0;
et42 = L1.^2.*L2.*L3.^2.*m1.*m2.*m3.*r2.*2.0+L1.^2.*L2.^2.*L3.*m1.*m2.*m3.*r3.*2.0+L1.*L2.^2.*L3.*m1.*m3.^2.*r1.*r3.*4.0+L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*4.0+L1.^2.*L2.*L3.*m2.^2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).^2.*2.0+L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*cos(th2).^2.*2.0+Iz3.*L1.*L2.*m1.*m2.*r1.*r2.*4.0+Iz2.*L1.*L3.*m1.*m3.*r1.*r3.*4.0+Iz1.*L2.*L3.*m2.*m3.*r2.*r3.*4.0-L1.*L2.*L3.^2.*m1.*m2.*m3.*r1.*r2.*4.0-L1.*L2.^2.*L3.*m1.*m2.*m3.*r1.*r3.*4.0-L1.^2.*L2.*L3.*m1.*m2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*cos(th2).^2.*4.0;
et43 = L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.*L3.*m1.*m2.*m3.*r1.*r2.*r3.*8.0;
et44 = Iz1.*Iz2.*Iz3-Iz2.*Iz3.*L1.^2.*m1-Iz1.*Iz3.*L2.^2.*m2+Iz2.*Iz3.*L1.^2.*m2-Iz1.*Iz2.*L3.^2.*m3+Iz1.*Iz3.*L2.^2.*m3+Iz2.*Iz3.*L1.^2.*m3-L1.^2.*L2.^2.*L3.^2.*m3.^3-Iz3.*L1.^2.*L2.^2.*m2.^2-Iz1.*L2.^2.*L3.^2.*m3.^2-Iz2.*L1.^2.*L3.^2.*m3.^2+Iz3.*L1.^2.*L2.^2.*m3.^2-Iz3.*L1.^2.*L2.^2.*m3.^2.*cos(th2).^2+Iz2.*Iz3.*L1.*m1.*r1.*2.0+Iz1.*Iz3.*L2.*m2.*r2.*2.0+Iz1.*Iz2.*L3.*m3.*r3.*2.0-Iz3.*L1.^2.*m2.^2.*r2.^2.*cos(th2).^2-Iz1.*L2.^2.*m3.^2.*r3.^2.*cos(th3).^2;
et45 = L1.^2.*L2.^2.*L3.*m3.^3.*r3.*2.0-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).^2+L1.^2.*L2.^2.*L3.^2.*m3.^3.*cos(th2).^2-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th3).^2+L1.^2.*L2.^2.*L3.^2.*m1.*m3.^2+L1.^2.*L2.^2.*L3.^2.*m2.^2.*m3+Iz3.*L1.^2.*L2.^2.*m1.*m2+Iz2.*L1.^2.*L3.^2.*m1.*m3-Iz3.*L1.^2.*L2.^2.*m1.*m3+Iz1.*L2.^2.*L3.^2.*m2.*m3-Iz2.*L1.^2.*L3.^2.*m2.*m3+Iz3.*L1.^2.*L2.*m2.^2.*r2.*2.0+Iz1.*L2.^2.*L3.*m3.^2.*r3.*2.0+Iz2.*L1.^2.*L3.*m3.^2.*r3.*2.0;
et46 = -Iz2.*L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2-L1.^2.*L2.^2.*L3.*m3.^3.*r3.*cos(th2).^2.*2.0-L1.^2.*L2.^2.*L3.^2.*m1.*m2.*m3-L1.*L2.^2.*L3.^2.*m1.*m3.^2.*r1.*2.0-L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*2.0-L1.^2.*L2.*L3.^2.*m2.^2.*m3.*r2.*2.0-L1.^2.*L2.^2.*L3.*m1.*m3.^2.*r3.*2.0-L1.^2.*L2.^2.*L3.*m2.^2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th2+th3).^2-Iz3.*L1.*L2.^2.*m1.*m2.*r1.*2.0-Iz2.*L1.*L3.^2.*m1.*m3.*r1.*2.0+Iz3.*L1.*L2.^2.*m1.*m3.*r1.*2.0-Iz3.*L1.^2.*L2.*m1.*m2.*r2.*2.0;
et47 = Iz1.*L2.*L3.^2.*m2.*m3.*r2.*-2.0-Iz2.*L1.^2.*L3.*m1.*m3.*r3.*2.0+Iz3.*L1.^2.*L2.*m2.*m3.*r2.*2.0-Iz1.*L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz2.*L1.^2.*L3.*m2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m1.*m3.^2.*r3.^2.*cos(th3).^2+L1.^2.*L3.^2.*m2.^2.*m3.*r2.^2.*cos(th2).^2-L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.^2.*m1.*m3.^2.*r1.*r3.^2.*cos(th3).^2.*2.0-L1.^2.*L3.*m2.^2.*m3.*r2.^2.*r3.*cos(th2).^2.*2.0-Iz3.*L1.^2.*L2.*m2.*m3.*r2.*cos(th2).^2.*2.0+L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.^2.*L3.^2.*m1.*m2.*m3.*r1.*2.0;
et48 = L1.^2.*L2.*L3.^2.*m1.*m2.*m3.*r2.*2.0+L1.^2.*L2.^2.*L3.*m1.*m2.*m3.*r3.*2.0+L1.*L2.^2.*L3.*m1.*m3.^2.*r1.*r3.*4.0+L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*4.0+L1.^2.*L2.*L3.*m2.^2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).^2.*2.0+L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*cos(th2).^2.*2.0+Iz3.*L1.*L2.*m1.*m2.*r1.*r2.*4.0+Iz2.*L1.*L3.*m1.*m3.*r1.*r3.*4.0+Iz1.*L2.*L3.*m2.*m3.*r2.*r3.*4.0-L1.*L2.*L3.^2.*m1.*m2.*m3.*r1.*r2.*4.0-L1.*L2.^2.*L3.*m1.*m2.*m3.*r1.*r3.*4.0-L1.^2.*L2.*L3.*m1.*m2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*cos(th2).^2.*4.0;
et49 = L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.*L3.*m1.*m2.*m3.*r1.*r2.*r3.*8.0;
et50 = tau1-L2.*g.*m3.*cos(th1+th2)-g.*m2.*r2.*cos(th1+th2)-L1.*g.*m2.*cos(th1)-L1.*g.*m3.*cos(th1)-g.*m1.*r1.*cos(th1)-g.*m3.*r3.*cos(th1+th2+th3)+L1.*dth2.^2.*m3.*r3.*sin(th2+th3)+L1.*dth3.^2.*m3.*r3.*sin(th2+th3)+L1.*L2.*dth2.^2.*m3.*sin(th2)+L1.*dth2.^2.*m2.*r2.*sin(th2)+L2.*dth3.^2.*m3.*r3.*sin(th3)+L1.*dth1.*dth2.*m3.*r3.*sin(th2+th3).*2.0+L1.*dth1.*dth3.*m3.*r3.*sin(th2+th3).*2.0+L1.*dth2.*dth3.*m3.*r3.*sin(th2+th3).*2.0+L1.*L2.*dth1.*dth2.*m3.*sin(th2).*2.0+L1.*dth1.*dth2.*m2.*r2.*sin(th2).*2.0+L2.*dth1.*dth3.*m3.*r3.*sin(th3).*2.0+L2.*dth2.*dth3.*m3.*r3.*sin(th3).*2.0;
et51 = (Iz2.*Iz3-L2.^2.*L3.^2.*m3.^2-Iz3.*L2.^2.*m2-Iz2.*L3.^2.*m3+Iz3.*L2.^2.*m3+L2.^2.*L3.^2.*m2.*m3+L2.^2.*L3.*m3.^2.*r3.*2.0+Iz3.*L2.*m2.*r2.*2.0+Iz2.*L3.*m3.*r3.*2.0-L2.^2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.*L3.^2.*m3.^2.*cos(th2)+Iz3.*L1.*L2.*m3.*cos(th2)-L2.*L3.^2.*m2.*m3.*r2.*2.0-L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz3.*L1.*m2.*r2.*cos(th2)-L1.*L2.*m3.^2.*r3.^2.*cos(th2+th3).*cos(th3)+L1.*L2.*L3.*m3.^2.*r3.*cos(th2).*2.0-L1.*L3.^2.*m2.*m3.*r2.*cos(th2)+L2.*L3.*m2.*m3.*r2.*r3.*4.0+L1.*L3.*m2.*m3.*r2.*r3.*cos(th2).*2.0)./(et44+et45+et46+et47+et48+et49);
et52 = -1.0;
et53 = ((-tau3-L2.^2.*dth2.^2.*m2.*sin(th3)+g.*m3.*r3.*cos(th1+th2+th3)+L1.*dth1.^2.*m3.*r3.*sin(th2+th3)+L2.*L3.*dth2.^2.*m2.*sin(th3)-L2.^2.*dth1.*dth2.*m2.*sin(th3)+L2.*dth2.^2.*m2.*r2.*sin(th3)+L2.*dth1.^2.*m3.*r3.*sin(th3)+L2.*L3.*dth1.*dth2.*m2.*sin(th3)+L2.*dth1.*dth2.*m2.*r2.*sin(th3)+L2.*dth1.*dth2.*m3.*r3.*sin(th3)).*(et28+et29))./(et30+et31+et32+et33+et34+et35);
et54 = -((et36+et37).*(-tau2+L2.*g.*m3.*cos(th1+th2)+g.*m2.*r2.*cos(th1+th2)+g.*m3.*r3.*cos(th1+th2+th3)+L1.*dth1.^2.*m3.*r3.*sin(th2+th3)+L1.*L2.*dth1.^2.*m3.*sin(th2)+L1.*dth1.^2.*m2.*r2.*sin(th2)-L2.*dth3.^2.*m3.*r3.*sin(th3)-L2.*dth1.*dth3.*m3.*r3.*sin(th3).*2.0-L2.*dth2.*dth3.*m3.*r3.*sin(th3).*2.0))./(et38+et39+et40+et41+et42+et43)+et50.*et51.*et52;
et55 = Iz1.*Iz2.*Iz3-Iz2.*Iz3.*L1.^2.*m1-Iz1.*Iz3.*L2.^2.*m2+Iz2.*Iz3.*L1.^2.*m2-Iz1.*Iz2.*L3.^2.*m3+Iz1.*Iz3.*L2.^2.*m3+Iz2.*Iz3.*L1.^2.*m3-L1.^2.*L2.^2.*L3.^2.*m3.^3-Iz3.*L1.^2.*L2.^2.*m2.^2-Iz1.*L2.^2.*L3.^2.*m3.^2-Iz2.*L1.^2.*L3.^2.*m3.^2+Iz3.*L1.^2.*L2.^2.*m3.^2-Iz3.*L1.^2.*L2.^2.*m3.^2.*cos(th2).^2+Iz2.*Iz3.*L1.*m1.*r1.*2.0+Iz1.*Iz3.*L2.*m2.*r2.*2.0+Iz1.*Iz2.*L3.*m3.*r3.*2.0-Iz3.*L1.^2.*m2.^2.*r2.^2.*cos(th2).^2-Iz1.*L2.^2.*m3.^2.*r3.^2.*cos(th3).^2;
et56 = L1.^2.*L2.^2.*L3.*m3.^3.*r3.*2.0-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).^2+L1.^2.*L2.^2.*L3.^2.*m3.^3.*cos(th2).^2-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th3).^2+L1.^2.*L2.^2.*L3.^2.*m1.*m3.^2+L1.^2.*L2.^2.*L3.^2.*m2.^2.*m3+Iz3.*L1.^2.*L2.^2.*m1.*m2+Iz2.*L1.^2.*L3.^2.*m1.*m3-Iz3.*L1.^2.*L2.^2.*m1.*m3+Iz1.*L2.^2.*L3.^2.*m2.*m3-Iz2.*L1.^2.*L3.^2.*m2.*m3+Iz3.*L1.^2.*L2.*m2.^2.*r2.*2.0+Iz1.*L2.^2.*L3.*m3.^2.*r3.*2.0+Iz2.*L1.^2.*L3.*m3.^2.*r3.*2.0;
et57 = -Iz2.*L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2-L1.^2.*L2.^2.*L3.*m3.^3.*r3.*cos(th2).^2.*2.0-L1.^2.*L2.^2.*L3.^2.*m1.*m2.*m3-L1.*L2.^2.*L3.^2.*m1.*m3.^2.*r1.*2.0-L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*2.0-L1.^2.*L2.*L3.^2.*m2.^2.*m3.*r2.*2.0-L1.^2.*L2.^2.*L3.*m1.*m3.^2.*r3.*2.0-L1.^2.*L2.^2.*L3.*m2.^2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th2+th3).^2-Iz3.*L1.*L2.^2.*m1.*m2.*r1.*2.0-Iz2.*L1.*L3.^2.*m1.*m3.*r1.*2.0+Iz3.*L1.*L2.^2.*m1.*m3.*r1.*2.0-Iz3.*L1.^2.*L2.*m1.*m2.*r2.*2.0;
et58 = Iz1.*L2.*L3.^2.*m2.*m3.*r2.*-2.0-Iz2.*L1.^2.*L3.*m1.*m3.*r3.*2.0+Iz3.*L1.^2.*L2.*m2.*m3.*r2.*2.0-Iz1.*L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz2.*L1.^2.*L3.*m2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m1.*m3.^2.*r3.^2.*cos(th3).^2+L1.^2.*L3.^2.*m2.^2.*m3.*r2.^2.*cos(th2).^2-L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.^2.*m1.*m3.^2.*r1.*r3.^2.*cos(th3).^2.*2.0-L1.^2.*L3.*m2.^2.*m3.*r2.^2.*r3.*cos(th2).^2.*2.0-Iz3.*L1.^2.*L2.*m2.*m3.*r2.*cos(th2).^2.*2.0+L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.^2.*L3.^2.*m1.*m2.*m3.*r1.*2.0;
et59 = L1.^2.*L2.*L3.^2.*m1.*m2.*m3.*r2.*2.0+L1.^2.*L2.^2.*L3.*m1.*m2.*m3.*r3.*2.0+L1.*L2.^2.*L3.*m1.*m3.^2.*r1.*r3.*4.0+L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*4.0+L1.^2.*L2.*L3.*m2.^2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).^2.*2.0+L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*cos(th2).^2.*2.0+Iz3.*L1.*L2.*m1.*m2.*r1.*r2.*4.0+Iz2.*L1.*L3.*m1.*m3.*r1.*r3.*4.0+Iz1.*L2.*L3.*m2.*m3.*r2.*r3.*4.0-L1.*L2.*L3.^2.*m1.*m2.*m3.*r1.*r2.*4.0-L1.*L2.^2.*L3.*m1.*m2.*m3.*r1.*r3.*4.0-L1.^2.*L2.*L3.*m1.*m2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*cos(th2).^2.*4.0;
et60 = L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.*L3.*m1.*m2.*m3.*r1.*r2.*r3.*8.0;
et61 = -tau2+L2.*g.*m3.*cos(th1+th2)+g.*m2.*r2.*cos(th1+th2)+g.*m3.*r3.*cos(th1+th2+th3)+L1.*dth1.^2.*m3.*r3.*sin(th2+th3)+L1.*L2.*dth1.^2.*m3.*sin(th2)+L1.*dth1.^2.*m2.*r2.*sin(th2)-L2.*dth3.^2.*m3.*r3.*sin(th3)-L2.*dth1.*dth3.*m3.*r3.*sin(th3).*2.0-L2.*dth2.*dth3.*m3.*r3.*sin(th3).*2.0;
et62 = (Iz2.*Iz3-L2.^2.*L3.^2.*m3.^2-Iz3.*L2.^2.*m2-Iz2.*L3.^2.*m3+Iz3.*L2.^2.*m3+L2.^2.*L3.^2.*m2.*m3+L2.^2.*L3.*m3.^2.*r3.*2.0+Iz3.*L2.*m2.*r2.*2.0+Iz2.*L3.*m3.*r3.*2.0-L2.^2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.*L3.^2.*m3.^2.*cos(th2)+Iz3.*L1.*L2.*m3.*cos(th2)-L2.*L3.^2.*m2.*m3.*r2.*2.0-L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz3.*L1.*m2.*r2.*cos(th2)-L1.*L2.*m3.^2.*r3.^2.*cos(th2+th3).*cos(th3)+L1.*L2.*L3.*m3.^2.*r3.*cos(th2).*2.0-L1.*L3.^2.*m2.*m3.*r2.*cos(th2)+L2.*L3.*m2.*m3.*r2.*r3.*4.0+L1.*L3.*m2.*m3.*r2.*r3.*cos(th2).*2.0)./(et55+et56+et57+et58+et59+et60);
et63 = Iz1.*Iz2.*Iz3-Iz2.*Iz3.*L1.^2.*m1-Iz1.*Iz3.*L2.^2.*m2+Iz2.*Iz3.*L1.^2.*m2-Iz1.*Iz2.*L3.^2.*m3+Iz1.*Iz3.*L2.^2.*m3+Iz2.*Iz3.*L1.^2.*m3-L1.^2.*L2.^2.*L3.^2.*m3.^3-Iz3.*L1.^2.*L2.^2.*m2.^2-Iz1.*L2.^2.*L3.^2.*m3.^2-Iz2.*L1.^2.*L3.^2.*m3.^2+Iz3.*L1.^2.*L2.^2.*m3.^2-Iz3.*L1.^2.*L2.^2.*m3.^2.*cos(th2).^2+Iz2.*Iz3.*L1.*m1.*r1.*2.0+Iz1.*Iz3.*L2.*m2.*r2.*2.0+Iz1.*Iz2.*L3.*m3.*r3.*2.0-Iz3.*L1.^2.*m2.^2.*r2.^2.*cos(th2).^2-Iz1.*L2.^2.*m3.^2.*r3.^2.*cos(th3).^2;
et64 = L1.^2.*L2.^2.*L3.*m3.^3.*r3.*2.0-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).^2+L1.^2.*L2.^2.*L3.^2.*m3.^3.*cos(th2).^2-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th3).^2+L1.^2.*L2.^2.*L3.^2.*m1.*m3.^2+L1.^2.*L2.^2.*L3.^2.*m2.^2.*m3+Iz3.*L1.^2.*L2.^2.*m1.*m2+Iz2.*L1.^2.*L3.^2.*m1.*m3-Iz3.*L1.^2.*L2.^2.*m1.*m3+Iz1.*L2.^2.*L3.^2.*m2.*m3-Iz2.*L1.^2.*L3.^2.*m2.*m3+Iz3.*L1.^2.*L2.*m2.^2.*r2.*2.0+Iz1.*L2.^2.*L3.*m3.^2.*r3.*2.0+Iz2.*L1.^2.*L3.*m3.^2.*r3.*2.0;
et65 = -Iz2.*L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2-L1.^2.*L2.^2.*L3.*m3.^3.*r3.*cos(th2).^2.*2.0-L1.^2.*L2.^2.*L3.^2.*m1.*m2.*m3-L1.*L2.^2.*L3.^2.*m1.*m3.^2.*r1.*2.0-L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*2.0-L1.^2.*L2.*L3.^2.*m2.^2.*m3.*r2.*2.0-L1.^2.*L2.^2.*L3.*m1.*m3.^2.*r3.*2.0-L1.^2.*L2.^2.*L3.*m2.^2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th2+th3).^2-Iz3.*L1.*L2.^2.*m1.*m2.*r1.*2.0-Iz2.*L1.*L3.^2.*m1.*m3.*r1.*2.0+Iz3.*L1.*L2.^2.*m1.*m3.*r1.*2.0-Iz3.*L1.^2.*L2.*m1.*m2.*r2.*2.0;
et66 = Iz1.*L2.*L3.^2.*m2.*m3.*r2.*-2.0-Iz2.*L1.^2.*L3.*m1.*m3.*r3.*2.0+Iz3.*L1.^2.*L2.*m2.*m3.*r2.*2.0-Iz1.*L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz2.*L1.^2.*L3.*m2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m1.*m3.^2.*r3.^2.*cos(th3).^2+L1.^2.*L3.^2.*m2.^2.*m3.*r2.^2.*cos(th2).^2-L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.^2.*m1.*m3.^2.*r1.*r3.^2.*cos(th3).^2.*2.0-L1.^2.*L3.*m2.^2.*m3.*r2.^2.*r3.*cos(th2).^2.*2.0-Iz3.*L1.^2.*L2.*m2.*m3.*r2.*cos(th2).^2.*2.0+L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.^2.*L3.^2.*m1.*m2.*m3.*r1.*2.0;
et67 = L1.^2.*L2.*L3.^2.*m1.*m2.*m3.*r2.*2.0+L1.^2.*L2.^2.*L3.*m1.*m2.*m3.*r3.*2.0+L1.*L2.^2.*L3.*m1.*m3.^2.*r1.*r3.*4.0+L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*4.0+L1.^2.*L2.*L3.*m2.^2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).^2.*2.0+L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*cos(th2).^2.*2.0+Iz3.*L1.*L2.*m1.*m2.*r1.*r2.*4.0+Iz2.*L1.*L3.*m1.*m3.*r1.*r3.*4.0+Iz1.*L2.*L3.*m2.*m3.*r2.*r3.*4.0-L1.*L2.*L3.^2.*m1.*m2.*m3.*r1.*r2.*4.0-L1.*L2.^2.*L3.*m1.*m2.*m3.*r1.*r3.*4.0-L1.^2.*L2.*L3.*m1.*m2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*cos(th2).^2.*4.0;
et68 = L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.*L3.*m1.*m2.*m3.*r1.*r2.*r3.*8.0;
et69 = Iz2.*Iz3-L2.^2.*L3.^2.*m3.^2-Iz3.*L2.^2.*m2-Iz2.*L3.^2.*m3+Iz3.*L2.^2.*m3+L2.^2.*L3.^2.*m2.*m3+L2.^2.*L3.*m3.^2.*r3.*2.0+Iz3.*L2.*m2.*r2.*2.0+Iz2.*L3.*m3.*r3.*2.0-L2.^2.*m3.^2.*r3.^2.*cos(th3).^2-L2.*L3.^2.*m2.*m3.*r2.*2.0-L2.^2.*L3.*m2.*m3.*r3.*2.0+L2.*L3.*m2.*m3.*r2.*r3.*4.0;
et70 = (tau1-L2.*g.*m3.*cos(th1+th2)-g.*m2.*r2.*cos(th1+th2)-L1.*g.*m2.*cos(th1)-L1.*g.*m3.*cos(th1)-g.*m1.*r1.*cos(th1)-g.*m3.*r3.*cos(th1+th2+th3)+L1.*dth2.^2.*m3.*r3.*sin(th2+th3)+L1.*dth3.^2.*m3.*r3.*sin(th2+th3)+L1.*L2.*dth2.^2.*m3.*sin(th2)+L1.*dth2.^2.*m2.*r2.*sin(th2)+L2.*dth3.^2.*m3.*r3.*sin(th3)+L1.*dth1.*dth2.*m3.*r3.*sin(th2+th3).*2.0+L1.*dth1.*dth3.*m3.*r3.*sin(th2+th3).*2.0+L1.*dth2.*dth3.*m3.*r3.*sin(th2+th3).*2.0+L1.*L2.*dth1.*dth2.*m3.*sin(th2).*2.0+L1.*dth1.*dth2.*m2.*r2.*sin(th2).*2.0+L2.*dth1.*dth3.*m3.*r3.*sin(th3).*2.0+L2.*dth2.*dth3.*m3.*r3.*sin(th3).*2.0)./(et63+et64+et65+et66+et67+et68);
et71 = Iz1.*Iz2.*Iz3-Iz2.*Iz3.*L1.^2.*m1-Iz1.*Iz3.*L2.^2.*m2+Iz2.*Iz3.*L1.^2.*m2-Iz1.*Iz2.*L3.^2.*m3+Iz1.*Iz3.*L2.^2.*m3+Iz2.*Iz3.*L1.^2.*m3-L1.^2.*L2.^2.*L3.^2.*m3.^3-Iz3.*L1.^2.*L2.^2.*m2.^2-Iz1.*L2.^2.*L3.^2.*m3.^2-Iz2.*L1.^2.*L3.^2.*m3.^2+Iz3.*L1.^2.*L2.^2.*m3.^2-Iz3.*L1.^2.*L2.^2.*m3.^2.*cos(th2).^2+Iz2.*Iz3.*L1.*m1.*r1.*2.0+Iz1.*Iz3.*L2.*m2.*r2.*2.0+Iz1.*Iz2.*L3.*m3.*r3.*2.0-Iz3.*L1.^2.*m2.^2.*r2.^2.*cos(th2).^2-Iz1.*L2.^2.*m3.^2.*r3.^2.*cos(th3).^2;
et72 = L1.^2.*L2.^2.*L3.*m3.^3.*r3.*2.0-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).^2+L1.^2.*L2.^2.*L3.^2.*m3.^3.*cos(th2).^2-L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th3).^2+L1.^2.*L2.^2.*L3.^2.*m1.*m3.^2+L1.^2.*L2.^2.*L3.^2.*m2.^2.*m3+Iz3.*L1.^2.*L2.^2.*m1.*m2+Iz2.*L1.^2.*L3.^2.*m1.*m3-Iz3.*L1.^2.*L2.^2.*m1.*m3+Iz1.*L2.^2.*L3.^2.*m2.*m3-Iz2.*L1.^2.*L3.^2.*m2.*m3+Iz3.*L1.^2.*L2.*m2.^2.*r2.*2.0+Iz1.*L2.^2.*L3.*m3.^2.*r3.*2.0+Iz2.*L1.^2.*L3.*m3.^2.*r3.*2.0;
et73 = -Iz2.*L1.^2.*m3.^2.*r3.^2.*cos(th2+th3).^2-L1.^2.*L2.^2.*L3.*m3.^3.*r3.*cos(th2).^2.*2.0-L1.^2.*L2.^2.*L3.^2.*m1.*m2.*m3-L1.*L2.^2.*L3.^2.*m1.*m3.^2.*r1.*2.0-L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*2.0-L1.^2.*L2.*L3.^2.*m2.^2.*m3.*r2.*2.0-L1.^2.*L2.^2.*L3.*m1.*m3.^2.*r3.*2.0-L1.^2.*L2.^2.*L3.*m2.^2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th2+th3).^2-Iz3.*L1.*L2.^2.*m1.*m2.*r1.*2.0-Iz2.*L1.*L3.^2.*m1.*m3.*r1.*2.0+Iz3.*L1.*L2.^2.*m1.*m3.*r1.*2.0-Iz3.*L1.^2.*L2.*m1.*m2.*r2.*2.0;
et74 = Iz1.*L2.*L3.^2.*m2.*m3.*r2.*-2.0-Iz2.*L1.^2.*L3.*m1.*m3.*r3.*2.0+Iz3.*L1.^2.*L2.*m2.*m3.*r2.*2.0-Iz1.*L2.^2.*L3.*m2.*m3.*r3.*2.0+Iz2.*L1.^2.*L3.*m2.*m3.*r3.*2.0+L1.^2.*L2.^2.*m1.*m3.^2.*r3.^2.*cos(th3).^2+L1.^2.*L3.^2.*m2.^2.*m3.*r2.^2.*cos(th2).^2-L1.^2.*L2.^2.*m2.*m3.^2.*r3.^2.*cos(th3).^2-L1.*L2.^2.*m1.*m3.^2.*r1.*r3.^2.*cos(th3).^2.*2.0-L1.^2.*L3.*m2.^2.*m3.*r2.^2.*r3.*cos(th2).^2.*2.0-Iz3.*L1.^2.*L2.*m2.*m3.*r2.*cos(th2).^2.*2.0+L1.^2.*L2.^2.*m3.^3.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.^2.*L3.^2.*m1.*m2.*m3.*r1.*2.0;
et75 = L1.^2.*L2.*L3.^2.*m1.*m2.*m3.*r2.*2.0+L1.^2.*L2.^2.*L3.*m1.*m2.*m3.*r3.*2.0+L1.*L2.^2.*L3.*m1.*m3.^2.*r1.*r3.*4.0+L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*4.0+L1.^2.*L2.*L3.*m2.^2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).^2.*2.0+L1.^2.*L2.*L3.^2.*m2.*m3.^2.*r2.*cos(th2).^2.*2.0+Iz3.*L1.*L2.*m1.*m2.*r1.*r2.*4.0+Iz2.*L1.*L3.*m1.*m3.*r1.*r3.*4.0+Iz1.*L2.*L3.*m2.*m3.*r2.*r3.*4.0-L1.*L2.*L3.^2.*m1.*m2.*m3.*r1.*r2.*4.0-L1.*L2.^2.*L3.*m1.*m2.*m3.*r1.*r3.*4.0-L1.^2.*L2.*L3.*m1.*m2.*m3.*r2.*r3.*4.0-L1.^2.*L2.*L3.*m2.*m3.^2.*r2.*r3.*cos(th2).^2.*4.0;
et76 = L1.^2.*L2.*m2.*m3.^2.*r2.*r3.^2.*cos(th2+th3).*cos(th2).*cos(th3).*2.0+L1.*L2.*L3.*m1.*m2.*m3.*r1.*r2.*r3.*8.0;
et77 = L1.*(-tau3-L2.^2.*dth2.^2.*m2.*sin(th3)+g.*m3.*r3.*cos(th1+th2+th3)+L1.*dth1.^2.*m3.*r3.*sin(th2+th3)+L2.*L3.*dth2.^2.*m2.*sin(th3)-L2.^2.*dth1.*dth2.*m2.*sin(th3)+L2.*dth2.^2.*m2.*r2.*sin(th3)+L2.*dth1.^2.*m3.*r3.*sin(th3)+L2.*L3.*dth1.*dth2.*m2.*sin(th3)+L2.*dth1.*dth2.*m2.*r2.*sin(th3)+L2.*dth1.*dth2.*m3.*r3.*sin(th3));
et78 = -(-Iz2.*m3.*r3.*cos(th2+th3)+Iz3.*L2.*m3.*cos(th2)+Iz3.*m2.*r2.*cos(th2)-L2.^2.*m3.^2.*r3.*cos(th2+th3)-L2.*L3.^2.*m3.^2.*cos(th2)+L2.^2.*m2.*m3.*r3.*cos(th2+th3)+L2.*L3.*m3.^2.*r3.*cos(th2).*2.0-L3.^2.*m2.*m3.*r2.*cos(th2)-L2.*m3.^2.*r3.^2.*cos(th2+th3).*cos(th3)+L2.^2.*m3.^2.*r3.*cos(th2).*cos(th3)-L2.*m2.*m3.*r2.*r3.*cos(th2+th3).*2.0+L3.*m2.*m3.*r2.*r3.*cos(th2).*2.0+L2.*m2.*m3.*r2.*r3.*cos(th2).*cos(th3))./(et71+et72+et73+et74+et75+et76);
dydt = [dth1;et61.*et62+et69.*et70+et77.*et78;dth2;et53+et54;dth3;et26+et27];
